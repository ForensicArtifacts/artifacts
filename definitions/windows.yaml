# Windows specific artifacts.

name: ApplicationEventLog
doc: Windows Application Event log.
collectors:
- collector_type: FILE
  args: {path_list: ['%%environ_systemroot%%\System32\winevt\Logs\AppEvent.evt']}
conditions: [os_major_version < 6]
labels: [Logs]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/Windows_Event_Log_(EVT)']
---
name: ApplicationEventLogEvtx
doc: Windows Application Event log for Vista or later systems.
collectors:
- collector_type: FILE
  args: {path_list: ['%%environ_systemroot%%\System32\winevt\Logs\Application.evtx']}
conditions: [os_major_version >= 6]
labels: [Logs]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/Windows_XML_Event_Log_(EVTX)']
---
name: AvailableTimeZones
doc: The timezones available on the system.
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list: ['HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Time Zones\*\*']
supported_os: [Windows]
urls: ['https://github.com/libyal/winreg-kb/wiki/Time-zone-keys']
---
name: EventLogs
doc: Windows Event logs.
collectors:
- collector_type: ARTIFACT
  args:
    artifact_list:
      - 'ApplicationEventLog'
      - 'ApplicationEventLogEvtx'
      - 'SecurityEventLog'
      - 'SecurityEventLogEvtx'
      - 'SystemEventLog'
      - 'SystemEventLogEvtx'
labels: [Logs]
supported_os: [Windows]
---
name: MFTFiles
doc: |
  $MFT and $MFTMirr files.

  GRR collection note: you currently need to specify 'use tsk' and
  'ignore download size limits' for this artifact to work. This will go away in
  the future.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemdrive%%\$MFT'
      - '%%environ_systemdrive%%\$MFTMirr'
labels: [System]
supported_os: [Windows]
---
name: PrefetchFiles
doc: Windows Prefetch files.
collectors:
- collector_type: FILE
  args: {path_list: ['%%environ_systemroot%%\Prefetch\*.pf']}
labels: [System]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/Prefetch']
---
name: ScheduledTasks
doc: Windows Scheduled Tasks.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemroot%%\Tasks\**10'
      - '%%environ_systemroot%%\System32\Tasks\**10'
      - '%%environ_systemroot%%\SysWow64\Tasks\**10'
supported_os: [Windows]
urls: ['http://forensicswiki.org/wiki/Windows#Scheduled_Tasks']
---
name: SecurityEventLog
doc: Windows Security Event log.
collectors:
- collector_type: FILE
  args: {path_list: ['%%environ_systemroot%%\System32\winevt\Logs\SecEvent.evt']}
conditions: [os_major_version < 6]
labels: [Logs]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/Windows_Event_Log_(EVT)']
---
name: SecurityEventLogEvtx
doc: Windows Security Event log for Vista or later systems.
collectors:
- collector_type: FILE
  args: {path_list: ['%%environ_systemroot%%\System32\winevt\Logs\Security.evtx']}
conditions: [os_major_version >= 6]
labels: [Logs]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/Windows_XML_Event_Log_(EVTX)']
---
name: SetupApiLogs
doc: Windows setup API logs.
collectors:
- collector_type: FILE
  args: {path_list: ['%%environ_systemroot%%\setupapi.log']}
  conditions: [os_major_version < 6]
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemroot%%\inf\setupapi.app.log'
      - '%%environ_systemroot%%\inf\setupapi.dev.log'
      - '%%environ_systemroot%%\inf\setupapi.offline.log'
  conditions: [os_major_version >= 6]
labels: [Logs]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/Setup_API_Logs']
---
name: SuperFetchFiles
doc: Windows SuperFetch files.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemroot%%\Prefetch\Ag*.db'
      - '%%environ_systemroot%%\Prefetch\Ag*.db.trx'
labels: [System]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/SuperFetch']
---
name: SystemEventLog
doc: Windows System Event log.
collectors:
- collector_type: FILE
  args: {path_list: ['%%environ_systemroot%%\System32\winevt\Logs\SysEvent.evt']}
conditions: [os_major_version < 6]
labels: [Logs]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/Windows_Event_Log_(EVT)']
---
name: SystemEventLogEvtx
doc: Windows System Event log for Vista or later systems.
collectors:
- collector_type: FILE
  args: {path_list: ['%%environ_systemroot%%\System32\winevt\Logs\System.evtx']}
conditions: [os_major_version >= 6]
labels: [Logs]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/Windows_XML_Event_Log_(EVTX)']
---
name: TerminalServicesEventLogEvtx
doc: Windows TerminalServices Event log.
collectors:
- collector_type: FILE
  args: {path_list: ['%%environ_systemroot%%\System32\winevt\Logs\Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx']}
conditions: [os_major_version >= 6]
labels: [Logs]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/Windows_XML_Event_Log_(EVTX)']
---
name: WindowsHostsFiles
doc: The Windows hosts and lmhosts file.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemroot%%\System32\Drivers\etc\Lmhosts'
      - '%%environ_systemroot%%\System32\Drivers\etc\hosts'
supported_os: [Windows]
---
name: WindowsPersistenceMechanisms
doc: Persistence mechanisms in Windows.
collectors:
- collector_type: ARTIFACT
  args:
    artifact_list: [WindowsRunKeys, WindowsServices]
  returned_types: [PersistenceFile]
labels: [Software]
supported_os: [Windows]
---
name: WindowsRecycleBin
doc: Windows Recycle Bin (Recyler, $Recycle.Bin) files.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '\$Recycle.Bin\**'
      - '\Recycler\**'
labels: [Users]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/Windows#Recycle_Bin']
---
name: WindowsRunKeys
doc: |
  Windows Run and RunOnce keys.

  Note users.sid will currently only expand to SIDs with profiles
  on the system, not all SIDs.
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\Run\*'
      - 'HKEY_USERS\%%users.sid%%\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Run\*'
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\RunOnce\*'
      - 'HKEY_USERS\%%users.sid%%\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\RunOnce\*'
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run\*'
      - 'HKEY_USERS\%%users.sid%%\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run\*'
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\*'
      - 'HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Run\*'
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce\*'
      - 'HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\RunOnce\*'
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx\*'
      - 'HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\RunOnceEx\*'
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run\*'
      - 'HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run\*'
labels: [Software]
supported_os: [Windows]
---
name: WindowsSearchDatabase
doc: Windows Search database (Windows.edb).
collectors:
- collector_type: FILE
  args: {path_list: ['%%environ_allusersappdata%%\Microsoft\Search\Data\Applications\Windows\Windows.edb']}
labels: [Software]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/Windows_Desktop_Search']
---
name: WindowsServices
doc: Windows services from the registry.
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - '%%current_control_set%%\services\*\*'
      - '%%current_control_set%%\services\*\Parameters\*'
labels: [Software]
supported_os: [Windows]
urls:
  - 'http://support.microsoft.com/kb/103000'
  - 'https://github.com/libyal/winreg-kb/wiki/System-keys'
---
name: WindowsSystemRegistryFiles
doc: Windows system Registry files.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemroot%%\System32\config\SAM'
      - '%%environ_systemroot%%\System32\config\SECURITY'
      - '%%environ_systemroot%%\System32\config\SOFTWARE'
      - '%%environ_systemroot%%\System32\config\SYSTEM'
      - '\System Volume Information\Syscache.hve'
labels: [System]
supported_os: [Windows]
urls: ['https://github.com/libyal/winreg-kb/wiki/Registry-files']
---
name: WindowsUserRecentFiles
doc: Windows user specific recent files.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%users.appdata%%\Roaming\Microsoft\Office\Recent\*'
      - '%%users.appdata%%\Roaming\Microsoft\Windows\Recent\*'
labels: [Users]
supported_os: [Windows]
---
name: WindowsUserRegistryFiles
doc: Windows user specific Registry files.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%users.homedir%%\NTUSER.DAT'
      - '%%users.homedir%%\NTUSER.MAN'
      - '%%users.localappdata%%\Microsoft\Windows\UsrClass.dat'
labels: [Users]
supported_os: [Windows]
urls: ['https://github.com/libyal/winreg-kb/wiki/Registry-files']
---
name: WMIComputerSystemProduct
doc: Computer System Product including Identifiying number queried from WMI.
collectors:
- collector_type: WMI
  args: {query: SELECT * FROM Win32_ComputerSystemProduct}
labels: [System]
supported_os: [Windows]
urls: ['http://msdn.microsoft.com/en-us/library/aa394105(v=vs.85).aspx']
---
name: WMIDrivers
doc: Installed drivers via Windows Management Instrumentation (WMI).
collectors:
- collector_type: WMI
  args: {query: 'SELECT DisplayName, Description, InstallDate, Name, PathName, Status,
      State, ServiceType from Win32_SystemDriver'}
conditions: [os_major_version >= 6]
labels: [Software]
supported_os: [Windows]
---
name: WMIHotFixes
doc: Installed hotfixes via Windows Management Instrumentation (WMI).
collectors:
- collector_type: WMI
  args: {query: SELECT * from Win32_QuickFixEngineering}
conditions: [os_major_version >= 6]
labels: [Software]
supported_os: [Windows]
---
name: WMIInstalledSoftware
doc: Installed software via Windows Management Instrumentation (WMI).
collectors:
- collector_type: WMI
  args: {query: 'SELECT Name, Vendor, Description, InstallDate, InstallDate2, Version
      from Win32_Product'}
conditions: [os_major_version >= 6]
labels: [Software]
supported_os: [Windows]
---
name: WMILogicalDisks
doc: Disk information via Windows Management Instrumentation (WMI).
collectors:
- collector_type: WMI
  args: {query: SELECT * FROM Win32_LogicalDisk}
labels: [System]
supported_os: [Windows]
urls: ['http://msdn.microsoft.com/en-us/library/aa394173(v=vs.85).aspx']
---
name: WMILoginUsers
doc: |
  Login Users via Windows Management Instrumentation (WMI).

  This WMI query may take a long time to complete when run on a domain and
  will create load on a domain controller.
collectors:
- collector_type: WMI
  args: {query: SELECT * from Win32_GroupUser where Name = "login_users"}
conditions: [os_major_version >= 6]
labels: [Software]
supported_os: [Windows]
---
name: WMIPhysicalMemory
doc: Physical memory information via Windows Management Instrumentation (WMI).
collectors:
- collector_type: WMI
  args: {query: SELECT * from Win32_PhysicalMemory}
conditions: [os_major_version >= 6]
labels: [System]
supported_os: [Windows]
urls: ["http://msdn.microsoft.com/en-us/library/aa394347%28v=vs.85%29.aspx"]
---
name: WMIProcessList
doc: Process listing via Windows Management Instrumentation (WMI).
collectors:
- collector_type: WMI
  args: {query: SELECT * from Win32_Process}
conditions: [os_major_version >= 6]
labels: [Software]
supported_os: [Windows]
---
name: WMIUsers
doc: |
  Users via Windows Management Instrumentation (WMI).

  Note that in a domain setup, this will probably return all users in the
  domain which will be expensive and slow. Consider limiting by SID like
  WMIProfileUsersHomeDir.
collectors:
- collector_type: WMI
  args: {query: SELECT * FROM Win32_UserAccount}
labels: [Users]
supported_os: [Windows]
urls: ['http://msdn.microsoft.com/en-us/library/windows/desktop/aa394507(v=vs.85).aspx']
---
name: WindowsHotkeyReplacement
doc: Hotkey executable replacement
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemroot%%\System32\sethc.exe'
      - '%%environ_systemroot%%\System32\utilman.exe'
      - '%%environ_systemroot%%\System32\magnifier.exe'
supported_os: [Windows]
---
name: WindowsAutorunInf
doc: Windows autorun.inf file
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemdrive%%\autorun.inf'
supported_os: [Windows]
---
name: WindowsAutoexec
doc: Windows autoexec.bat file
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemdrive%%\autoexec.bat'
      - '%%environ_windir%%\autoexec.nt'
supported_os: [Windows]
---
name: WindowsConfigSys
doc: Windows config.sys file
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemdrive%%\config.sys'
      - '%%environ_windir%%\config.nt'
supported_os: [Windows]
---
name: WindowsGroupPolicyScripts
doc: Windows group policy scripts
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemdroot%%\GroupPolicy\User\Scripts\scripts.ini'
supported_os: [Windows]
---
name: WindowsWinstart
doc: Windows winstart.bat file
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_windir%%\winstart.bat'
      - '%%environ_windir%%\dosstart.bat'
supported_os: [Windows]
---
name: WindowsIniFiles
doc: Windows ini file 
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemdrive%%\system.ini'
      - '%%environ_windir%%\win.ini'
      - '%%environ_windir%%\wininit.ini'
supported_os: [Windows]
---
name: WindowsCommonFilePlacementAttacks
doc: Common files associated with search order hijacking and other file placement attacks
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemdrive%%\program.exe'
      - '%%environ_systemdrive%%\explorer.exe'
      - '%%environ_systemroot%%\System32\oci.dll'
      - '%%environ_systemroot%%\SysWOW64\oci.dll'
      - '%%environ_systemroot%%\linkinfo.dll'
      - '%%environ_systemroot%%\ntshrui.dll'
      - '%%environ_systemroot%%\System32\sysprep\cryptbase.dll'
      - '%%environ_systemroot%%\SysWOW64\sysprep\cryptbase.dll'
      - '%%environ_programfiles%%\Internet Explorer\sxs.dll'
      - '%%environ_programfilesx86%%\Internet Explorer\sxs.dll'
supported_os: [Windows]
---
name: WindowsStartupFolders
doc: Windows startup folder persistence
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%users.homedir%%\Start Menu\Programs\Startup\*'
      - '%%environ_allusersprofile%%\Start Menu\Programs\Startup\*'
      - '%%users.homedir%%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\*'
      - '%%environ_allusersprofile%%\Microsoft\Windows\Start Menu\Programs\Startup\*'
supported_os: [Windows]
---
name: WindowsStubPaths
doc: Windows StubPath persistence
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Active Setup\Installed Components\*\StubPath'
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Active Setup\Installed Components\*\StubPath'
supported_os: [Windows]
---
name: WindowsBootExecute
doc: Windows BootExecute persistence
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\BootExecute'
supported_os: [Windows]
---
name: WindowsNetshHelpers
doc: Windows Netsh helpers are loaded on boot 
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Netsh\*'
supported_os: [Windows]
---
name: WindowsPendingFileRenames
doc: Windows Pending file renames on reboot
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\PendingFileRenameOperations'
supported_os: [Windows]
---
name: WindowsExcludeFromKnownDlls
doc: ExcludeFromKnownDlls can be used to bypass search order hijacking protection
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\ExcludeFromKnownDlls'
supported_os: [Windows]
---
name: WindowsAppCertDlls
doc: Windows AppCertDlls persistence
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\AppCertDlls'
supported_os: [Windows]
---
name: WindowsStartupFolderModification
doc: Windows startup folder registry values
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\Common Startup'
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\Common Startup'
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\Startup'
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\Startup'
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Common Startup'
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Common Startup'
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Startup'
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Startup'
supported_os: [Windows]
---
name: WindowsDebugger
doc: Windows Debugger peristence or AV disable
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\*\Debugger'
      - 'HKEY_USERS\%%users.sid%%\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\*\Debugger'
supported_os: [Windows]
---
name: WindowsRunServices
doc: Windows Run Services
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce\*'
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce\*'
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices\*'
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\RunServices\*'
supported_os: [Windows]
---
name: WindowsWinlogonNotify
doc: Windows Winlogon Notify
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify'
      - 'HKEY_USERS\%%users.sid%%\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify'
supported_os: [Windows]
---
name: WindowsWinlogonMSGina
doc: Windows Winlogon MSGina
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GinaDll'
      - 'HKEY_USERS\%%users.sid%%\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GinaDll'
supported_os: [Windows]
---
name: WindowsWinlogonTaskman
doc: Windows Winlogon Taskman
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Taskman'
      - 'HKEY_USERS\%%users.sid%%\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Taskman'
supported_os: [Windows]
---
name: WindowsWinlogonUserinit
doc: Windows Winlogon Userinit
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit'
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit'
supported_os: [Windows]
---
name: WindowsWinlogonShell
doc: Windows shell replacement
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell'
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell'
supported_os: [Windows]
---
name: WindowsMSDTCDlls
doc: Windows MSDTC attempts to load these dlls on start
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSDTC\MTxOCI\*'
      - 'HKEY_USERS\%%users.sid%%\SOFTWARE\Microsoft\MSDTC\MTxOCI\*'
supported_os: [Windows]
---
name: WindowsPolicyShell
doc: Windows shell replacement
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\Policies\System\Shell'
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\Shell'
supported_os: [Windows]
---
name: WindowsLoadKey
doc: Windows load key
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows\load'
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows NT\CurrentVersion\Windows\load'
supported_os: [Windows]
---
name: WindowsAppInit
doc: Windows AppInit persistence
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs'
      - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs'
supported_os: [Windows]
---
name: WindowsInProcServer
doc: Windows InProcServer entries
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_CURRENT_ROOT\CLSID\*\InProcServer32'
      - 'HKEY_CURRENT_ROOT\Wow6432Node\CLSID\*\InProcServer32'
supported_os: [Windows]
---
name: WindowsLSAAuthenticationPackages
doc: Windows LSA Authentication Packages
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\Authentication Packages'
supported_os: [Windows]
---
name: WindowsLSASecurityPackages
doc: Windows LSA Security Packages
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\Security Packages'
supported_os: [Windows]
---
name: WindowsLSANotificationPackages
doc: Windows LSA Notification Packages will be called any time a password change occurs
collectors:
- collector_type: REGISTRY_KEY
  args:
    path_list:
      - 'HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\Notification Packages'
urls: http://carnal0wnage.attackresearch.com/2013/09/stealing-passwords-every-time-they.html
supported_os: [Windows]
---
name: WMILoggedOnSessions
doc: Logged on users queried from WMI.
collectors:
- collector_type: WMI
  args: {query: SELECT * FROM Win32_LogonSession}
supported_os: [Windows]
---
name: WMILoggedOnUsers
doc: Logged on users queried from WMI.
collectors:
- collector_type: WMI
  args: {query: SELECT * FROM Win32_LoggedonUser}
supported_os: [Windows]
---
name: WMIServices
doc: Services queried from WMI.
collectors:
- collector_type: WMI
  args: {query: SELECT * FROM Win32_Service}
supported_os: [Windows]
